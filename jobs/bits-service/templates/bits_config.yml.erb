buildpacks:
  blobstore_type: <%= p("bits-service.buildpacks.fog_connection.provider") %>
  <% if p("bits-service.buildpacks.fog_connection.provider").downcase == "local" %>
  local_config:
    path_prefix: /var/vcap/store/bits-service/<%= p("bits-service.buildpacks.directory_key") %>
  <% end %>
  <% if p("bits-service.buildpacks.fog_connection.provider").downcase == "aws" %>
  s3_config:
    bucket: <%= p("bits-service.buildpacks.directory_key") %>
    access_key_id: <%= p("bits-service.buildpacks.fog_connection.aws_access_key_id") %>
    secret_access_key: <%= p("bits-service.buildpacks.fog_connection.aws_secret_access_key") %>
    region: <%= p("bits-service.droplets.fog_connection.region") %>
  <% end %>

droplets:
  blobstore_type: <%= p("bits-service.droplets.fog_connection.provider") %>
  <% if p("bits-service.droplets.fog_connection.provider").downcase == "local" %>
  local_config:
    path_prefix: /var/vcap/store/bits-service/<%= p("bits-service.droplets.directory_key") %>
  <% end %>
  <% if p("bits-service.droplets.fog_connection.provider").downcase == "aws" %>
  s3_config:
    bucket: <%= p("bits-service.droplets.directory_key") %>
    access_key_id: <%= p("bits-service.droplets.fog_connection.aws_access_key_id") %>
    secret_access_key: <%= p("bits-service.droplets.fog_connection.aws_secret_access_key") %>
    region: <%= p("bits-service.droplets.fog_connection.region") %>
  <% end %>

packages:
  blobstore_type: <%= p("bits-service.packages.fog_connection.provider") %>
  <% if p("bits-service.packages.fog_connection.provider").downcase == "local" %>
  local_config:
    path_prefix: /var/vcap/store/bits-service/<%= p("bits-service.packages.directory_key") %>
  <% end %>
  <% if p("bits-service.packages.fog_connection.provider").downcase == "aws" %>
  s3_config:
    bucket: <%= p("bits-service.packages.directory_key") %>
    access_key_id: <%= p("bits-service.packages.fog_connection.aws_access_key_id") %>
    secret_access_key: <%= p("bits-service.packages.fog_connection.aws_secret_access_key") %>
    region: <%= p("bits-service.droplets.fog_connection.region") %>
  <% end %>

app_stash:
  blobstore_type: <%= p("bits-service.app_stash.fog_connection.provider") %>
  <% if p("bits-service.app_stash.fog_connection.provider").downcase == "local" %>
  local_config:
    path_prefix: /var/vcap/store/bits-service/<%= p("bits-service.app_stash.directory_key") %>
  <% end %>
  <% if p("bits-service.app_stash.fog_connection.provider").downcase == "aws" %>
  s3_config:
    bucket: <%= p("bits-service.app_stash.directory_key") %>
    access_key_id: <%= p("bits-service.app_stash.fog_connection.aws_access_key_id") %>
    secret_access_key: <%= p("bits-service.app_stash.fog_connection.aws_secret_access_key") %>
    region: <%= p("bits-service.droplets.fog_connection.region") %>
  <% end %>

logging:
  file: /var/vcap/sys/log/bits-service/bits-service.log
  syslog: vcap.bits-service
  level: <%= p("bits-service.logging.level") %>
  max_retries: <%= p("bits-service.logging.max_retries") %>
private_endpoint: <%= p("bits-service.private_endpoint") %>
public_endpoint: <%= p("bits-service.public_endpoint") %>
port: 80
secret: <%= p("bits-service.secret") %>
skip_cert_verify: true
<% if_p("bits-service.cc_updates.ca_cert", "bits-service.cc_updates.client_cert", "bits-service.cc_updates.client_key") do %>
cc_updates:
  cc_url: <%= p("bits-service.cc_updates.cc_url") %>
  ca_cert: "/var/vcap/jobs/bits-service/config/certs/mutual_ca_cert.pem"
  client_cert: "/var/vcap/jobs/bits-service/config/certs/mutual_client_cert.pem"
  client_key: "/var/vcap/jobs/bits-service/config/certs/mutual_client_key.pem"
<% end %>
signing_users:
  <% p('bits-service.signing_users').each do |user| %>
  - username: <%= user['username'] %>
    password: <%= user['password'] %>
  <% end %>
max_body_size: <%= p("bits-service.max_body_size") %>;
